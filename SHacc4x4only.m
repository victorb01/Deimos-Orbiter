function [acc,U] = SHacc4x4only(x,R,mu,J,C,S)
%INPUTS: 
% x (position vector expressed in expressed IAU body-fixed (rotating) frame and body parameters:  
% R (mean Radius), 
% mu (gravitational parameter), 
% J (vector of length 4 of unnormalized zonal gravity coefficients), 
% C and S (4x4 matrices of unnormalized cross term gravity coefficients)
%OUTPUTS: 
% acc (nonspherical inertial acceleration evaluated at x, expressed IAU body-fixed frame) 
% U   (potential evaluated at x) 
%UNITS: 
% {x(1:3),R,mu} must be expressed in consistent dimensioned units; 
% {J,C,S} are unnormalized, unitless;
% {acc(1:3),U} will be dimenesioned, same as input units;

t1 = x(1) ^ 2;
t2 = x(2) ^ 2;
t3 = x(3) ^ 2;
t4 = t1 + t2 + t3;
t5 = sqrt(t4);
t7 = 0.1e1 / t5 / t4;
t8 = mu * t7;
t9 = R ^ 2;
t10 = J(2) * t9;
t11 = 0.1e1 / t4;
t12 = t3 * t11;
t14 = 0.3e1 / 0.2e1 * t12 - 0.1e1 / 0.2e1;
t17 = t4 ^ 2;
t18 = 0.1e1 / t17;
t19 = mu * t18;
t20 = t9 * R;
t21 = J(3) * t20;
t22 = t3 * x(3);
t23 = t22 * t7;
t24 = t12 - 0.1e1;
t25 = t24 * x(3);
t26 = 0.1e1 / t5;
t27 = t25 * t26;
t29 = t23 + 0.3e1 / 0.2e1 * t27;
t33 = 0.1e1 / t5 / t17;
t34 = mu * t33;
t35 = t9 ^ 2;
t36 = J(4) * t35;
t37 = t3 ^ 2;
t39 = t24 * t3;
t42 = t24 ^ 2;
t44 = t37 * t18 + 0.3e1 * t39 * t11 + 0.3e1 / 0.8e1 * t42;
t47 = mu * t11;
t48 = sqrt(-t24);
t49 = R * t48;
t50 = C(1,1) * x(1);
t51 = t1 + t2;
t52 = sqrt(t51);
t53 = 0.1e1 / t52;
t55 = S(1,1) * x(2);
t57 = t50 * t53 + t55 * t53;
t60 = t19 * t9;
t61 = t48 * x(3);
t62 = C(2,1) * x(1);
t64 = S(2,1) * x(2);
t66 = t62 * t53 + t64 * t53;
t70 = -0.3e1 * t9 * t24;
t71 = 0.1e1 / t51;
t73 = 0.2e1 * t1 * t71;
t74 = t73 - 0.1e1;
t76 = S(2,2) * x(2);
t77 = x(1) * t71;
t80 = C(2,2) * t74 + 0.2e1 * t76 * t77;
t83 = t19 * t20;
t85 = 0.360e3 * t12 - 0.72e2;
t86 = t48 * t85;
t87 = C(3,1) * x(1);
t89 = S(3,1) * x(2);
t91 = t87 * t53 + t89 * t53;
t95 = t34 * t20;
t96 = -t24 * x(3);
t98 = S(3,2) * x(2);
t101 = C(3,2) * t74 + 0.2e1 * t98 * t77;
t105 = -t48 * t24;
t106 = t20 * t105;
t107 = x(1) * t53;
t110 = 0.2e1 * t107 * t74 - t107;
t113 = 0.1e1 / t52 / t51;
t114 = t1 * t113;
t118 = 0.4e1 * t114 * x(2) - x(2) * t53;
t120 = C(3,3) * t110 + S(3,3) * t118;
t124 = t34 * t35;
t127 = 0.3840e4 * t23 + 0.2880e4 * t27;
t128 = t48 * t127;
t129 = C(4,1) * x(1);
t131 = S(4,1) * x(2);
t133 = t129 * t53 + t131 * t53;
t138 = 0.20160e5 * t12 - 0.2880e4;
t139 = -t24 * t138;
t141 = S(4,2) * x(2);
t144 = 0.2e1 * t141 * t77 + C(4,2) * t74;
t148 = t17 * t4;
t149 = 0.1e1 / t148;
t150 = mu * t149;
t151 = t150 * t35;
t152 = t105 * x(3);
t155 = C(4,3) * t110 + S(4,3) * t118;
t159 = t35 * t42;
t165 = x(2) * t71;
t169 = C(4,4) * (0.2e1 * t107 * t110 - t73 + 0.1e1) + 0.2e1 * S(4,4) * (t107 * t118 - t165 * x(1));
t173 = -t8 * t10 * t14 - t19 * t21 * t29 - t34 * t36 * t44 + t47 * t49 * t57 + 0.3e1 * t60 * t61 * t66 + t8 * t70 * t80 + t83 * t86 * t91 / 0.48e2 + 0.15e2 * t95 * t96 * t101 + 0.15e2 * t19 * t106 * t120 + t124 * t128 * t133 / 0.384e3 + t124 * t139 * t144 / 0.384e3 + 0.105e3 * t151 * t152 * t155 + 0.105e3 * t34 * t159 * t169;
t174 = t34 * J(2);
t175 = t9 * t14;
t181 = mu / t5 / t148;
t182 = t181 * J(2);
t183 = t9 * t3;
t187 = t150 * J(3);
t188 = t20 * t29;
t192 = t181 * J(4);
t193 = t35 * t44;
t197 = t19 * R;
t198 = t48 * t57;
t205 = t113 * x(1);
t211 = t34 * t9;
t212 = -0.3e1 * t24 * t80;
t216 = t181 * t9;
t217 = t3 * x(1);
t229 = t1 * x(1);
t230 = t51 ^ 2;
t231 = 0.1e1 / t230;
t232 = t229 * t231;
t233 = t77 - t232;
t235 = t231 * t1;
t244 = t17 ^ 2;
t247 = mu / t5 / t244;
t248 = t247 * t20;
t253 = t150 * t20;
t254 = t105 * t120;
t258 = t22 * t33;
t259 = t258 * x(1);
t262 = t25 * t7 * x(1);
t292 = 0.8e1 * t107 * t233 - 0.2e1 * t114 * t74 + 0.2e1 * t53 * t74 + t114 - t53;
t294 = t205 * x(2);
t297 = 0.1e1 / t52 / t230;
t299 = t229 * t297 * x(2);
t301 = 0.9e1 * t294 - 0.12e2 * t299;
t307 = t181 * t35;
t308 = t42 * t169;
t313 = mu / t244;
t314 = 0.1e1 / t48;
t316 = t313 * t20 * t314;
t317 = t85 * t91;
t322 = t247 * t35 * t314;
t323 = t127 * t133;
t327 = 0.3e1 * t174 * t175 * x(1) + 0.3e1 * t182 * t183 * x(1) + 0.4e1 * t187 * t188 * x(1) + 0.5e1 * t192 * t193 * x(1) - 0.2e1 * t197 * t198 * x(1) + 0.3e1 * t60 * t61 * (-C(2,1) * t1 * t113 - t64 * t205 + C(2,1) * t53) - 0.3e1 * t211 * t212 * x(1) + 0.6e1 * t216 * t217 * t80 + t83 * t86 * (-C(3,1) * t1 * t113 - t89 * t205 + C(3,1) * t53) / 0.48e2 + 0.15e2 * t95 * t96 * (0.4e1 * C(3,2) * t233 - 0.4e1 * t98 * t235 + 0.2e1 * t98 * t71) + 0.30e2 * t248 * t22 * x(1) * t101 - 0.60e2 * t253 * t254 * x(1) + t124 * t48 * (-0.17280e5 * t259 - 0.2880e4 * t262) * t133 / 0.384e3 + t124 * t128 * (-C(4,1) * t1 * t113 - t131 * t205 + C(4,1) * t53) / 0.384e3 + t124 * t139 * (-0.4e1 * t141 * t235 + 0.2e1 * t141 * t71 + 0.4e1 * C(4,2) * t233) / 0.384e3 + 0.105e3 * t151 * t152 * (C(4,3) * t292 + S(4,3) * t301) - 0.525e3 * t307 * t308 * x(1) + t316 * t317 * t217 / 0.48e2 + t322 * t323 * t217 / 0.384e3;
t328 = t247 * t35;
t329 = t138 * t144;
t333 = -t24 * t3;
t334 = x(1) * t144;
t338 = t313 * t35;
t339 = t155 * x(1);
t346 = mu / t244 / t4 * t35;
t347 = t48 * t22;
t351 = -t24 * t169;
t355 = t150 * R;
t356 = t314 * t57;
t359 = t150 * t9;
t360 = t66 * x(1);
t364 = t313 * t9;
t365 = t314 * t22;
t369 = t91 * x(1);
t373 = t313 * t20;
t374 = t48 * t3;
t378 = t181 * t20;
t383 = t48 * t120;
t399 = t37 * t149;
t447 = 0.4e1 * x(2) * t231 * t1;
t455 = t328 * t217 * t329 / 0.192e3 - 0.105e3 * t328 * t333 * t334 - 0.630e3 * t338 * t152 * t339 + 0.315e3 * t346 * t347 * t339 + 0.420e3 * t328 * t351 * t217 + t355 * t356 * t217 - 0.12e2 * t359 * t61 * t360 + 0.3e1 * t364 * t365 * t360 - t253 * t86 * t369 / 0.12e2 - 0.15e2 * t373 * t374 * t369 - 0.75e2 * t378 * t96 * t101 * x(1) + 0.45e2 * t373 * t383 * t217 - 0.5e1 / 0.384e3 * t307 * t128 * t133 * x(1) - 0.5e1 / 0.384e3 * t307 * t139 * t334 - t19 * t21 * (-0.6e1 * t259 - 0.3e1 / 0.2e1 * t262) - t34 * t36 * (-0.10e2 * t399 * x(1) - 0.15e2 / 0.2e1 * t39 * t18 * x(1)) + t47 * t49 * (-C(1,1) * t1 * t113 - t55 * t205 + C(1,1) * t53) + t8 * t70 * (0.4e1 * C(2,2) * t233 - 0.4e1 * t76 * t235 + 0.2e1 * t76 * t71) + 0.15e2 * t19 * t106 * (C(3,3) * t292 + S(3,3) * t301) + 0.105e3 * t34 * t159 * (C(4,4) * (0.2e1 * t107 * t292 - 0.2e1 * t114 * t110 + 0.2e1 * t53 * t110 + 0.4e1 * t232 - 0.4e1 * t77) + S(4,4) * (0.2e1 * t107 * t301 - 0.2e1 * t114 * t118 + 0.2e1 * t53 * t118 - 0.2e1 * t165 + t447));
t472 = t113 * x(2);
t484 = t3 * x(2);
t503 = t231 * x(1);
t517 = t258 * x(2);
t520 = t25 * t7 * x(2);
t552 = -0.2e1 * t205 * t74 * x(2) + t294 - 0.8e1 * t299;
t559 = -0.12e2 * t1 * t297 * t2 + t2 * t113 + 0.4e1 * t114 - t53;
t574 = 0.3e1 * t174 * t175 * x(2) + 0.3e1 * t182 * t183 * x(2) + 0.4e1 * t187 * t188 * x(2) + 0.5e1 * t192 * t193 * x(2) - 0.2e1 * t197 * t198 * x(2) + 0.3e1 * t60 * t61 * (-S(2,1) * t2 * t113 - t62 * t472 + S(2,1) * t53) - 0.3e1 * t211 * t212 * x(2) + 0.6e1 * t216 * t484 * t80 + t83 * t86 * (-S(3,1) * t2 * t113 - t87 * t472 + S(3,1) * t53) / 0.48e2 + 0.15e2 * t95 * t96 * (-0.4e1 * S(3,2) * t2 * t503 - 0.4e1 * C(3,2) * x(2) * t235 + 0.2e1 * S(3,2) * t71 * x(1)) + 0.30e2 * t248 * t22 * x(2) * t101 - 0.60e2 * t253 * t254 * x(2) + t124 * t48 * (-0.17280e5 * t517 - 0.2880e4 * t520) * t133 / 0.384e3 + t124 * t128 * (-S(4,1) * t2 * t113 - t129 * t472 + S(4,1) * t53) / 0.384e3 + t124 * t139 * (-0.4e1 * S(4,2) * t2 * t503 - 0.4e1 * C(4,2) * x(2) * t235 + 0.2e1 * S(4,2) * t71 * x(1)) / 0.384e3 + 0.105e3 * t151 * t152 * (C(4,3) * t552 + S(4,3) * t559) - 0.525e3 * t307 * t308 * x(2) + t322 * t323 * t484 / 0.384e3 + t316 * t317 * t484 / 0.48e2;
t579 = t144 * x(2);
t589 = t155 * x(2);
t601 = t66 * x(2);
t608 = t91 * x(2);
t682 = -0.5e1 / 0.384e3 * t307 * t128 * t133 * x(2) - 0.5e1 / 0.384e3 * t307 * t139 * t579 + t328 * t484 * t329 / 0.192e3 - 0.105e3 * t328 * t333 * t579 - 0.630e3 * t338 * t152 * t589 + t355 * t356 * t484 + 0.315e3 * t346 * t347 * t589 + 0.420e3 * t328 * t351 * t484 - 0.12e2 * t359 * t61 * t601 + 0.3e1 * t364 * t365 * t601 - t253 * t86 * t608 / 0.12e2 - 0.15e2 * t373 * t374 * t608 - 0.75e2 * t378 * t96 * t101 * x(2) + 0.45e2 * t373 * t383 * t484 + 0.105e3 * t34 * t159 * (C(4,4) * (-0.2e1 * t205 * t110 * x(2) + 0.2e1 * t107 * t552 + t447) + S(4,4) * (-0.2e1 * t205 * t118 * x(2) + 0.4e1 * t2 * t231 * x(1) + 0.2e1 * t107 * t559 - 0.2e1 * t77)) - t19 * t21 * (-0.6e1 * t517 - 0.3e1 / 0.2e1 * t520) - t34 * t36 * (-0.10e2 * t399 * x(2) - 0.15e2 / 0.2e1 * t39 * t18 * x(2)) + t47 * t49 * (-S(1,1) * t2 * t113 - t50 * t472 + S(1,1) * t53) + t8 * t70 * (-0.4e1 * S(2,2) * t2 * t503 - 0.4e1 * C(2,2) * x(2) * t235 + 0.2e1 * S(2,2) * t71 * x(1)) + 0.15e2 * t19 * t106 * (C(3,3) * t552 + S(3,3) * t559);
t695 = t22 * t18;
t696 = -x(3) * t11 + t695;
t726 = t3 * t7;
t728 = t37 * t33;
t731 = -0.2e1 * t696 * x(3) * t26;
t733 = t24 * t26;
t735 = t39 * t7;
t754 = 0.3e1 * t174 * t175 * x(3) + 0.4e1 * t187 * t188 * x(3) + 0.5e1 * t192 * t193 * x(3) + t47 * R * t356 * t696 - 0.2e1 * t197 * t198 * x(3) - 0.12e2 * t359 * t374 * t66 - 0.3e1 * t211 * t212 * x(3) - 0.15e2 * t83 * t48 * t696 * t91 + 0.30e2 * t95 * t696 * x(3) * t101 - 0.75e2 * t378 * t333 * t101 + 0.45e2 * t83 * t383 * t696 - 0.60e2 * t253 * t254 * x(3) + t124 * t48 * (0.11520e5 * t726 - 0.11520e5 * t728 + 0.2880e4 * t731 + 0.2880e4 * t733 - 0.2880e4 * t735) * t133 / 0.384e3 + t124 * t696 * t138 * t144 / 0.192e3 + 0.105e3 * t124 * t24 * t696 * t144 - 0.630e3 * t338 * t105 * t3 * t155;
t834 = 0.420e3 * t124 * t351 * t696 - 0.525e3 * t307 * t308 * x(3) + 0.3e1 * t60 * t314 * x(3) * t66 * t696 + t83 * t314 * t85 * t91 * t696 / 0.48e2 - t253 * t86 * t91 * x(3) / 0.12e2 + t124 * t314 * t127 * t133 * t696 / 0.384e3 - 0.5e1 / 0.384e3 * t307 * t128 * t133 * x(3) - 0.5e1 / 0.384e3 * t307 * t139 * t144 * x(3) + 0.315e3 * t151 * t61 * t155 * t696 + 0.105e3 * t150 * t35 * t105 * t155 + 0.3e1 * t8 * t10 * t696 - t19 * t21 * (0.3e1 * t726 - 0.3e1 * t728 + 0.3e1 / 0.2e1 * t731 + 0.3e1 / 0.2e1 * t733 - 0.3e1 / 0.2e1 * t735) - t34 * t36 * (0.4e1 * t695 - 0.4e1 * t37 * x(3) * t149 - 0.6e1 * t696 * t3 * t11 + 0.6e1 * t25 * t11 - 0.6e1 * t24 * t22 * t18 - 0.3e1 / 0.2e1 * t24 * t696) + 0.6e1 * t8 * t9 * t696 * t80 + 0.3e1 * t19 * t9 * t48 * t66 - 0.15e2 * t34 * t20 * t24 * t101;
U = t173;
acc(1,1) = t327 + t455;
acc(2,1) = t574 + t682;
acc(3,1) = t754 + t834;


end